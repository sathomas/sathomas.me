<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Arbitrary Statistical Models</title>
		<link rel="icon" href="/favicon.ico" sizes="32x32">
		<link rel="icon" href="/icon.svg" type="image/svg+xml">
		<link rel="apple-touch-icon" href="/apple-touch-icon.png">
		<meta name="description" content="A simple example demonstrating various modeling approaches available in Stata">
		<link rel="alternate" href="feed/feed.xml" type="application/atom+xml" title="Stephen Thomas">
		<meta name="format-detection" content="telephone=no">
		<meta name="generator" content="Eleventy v3.0.0">
		
		<style>/*!
 * LaTeX prism.css (https://latex.vercel.app/#syntax-highlighting)
 * Based on the default prism.js theme for JavaScript, CSS and HTML by Lea Verou
 *
 * Source: https://github.com/vincentdoerig/latex-css/tree/master/prism
 * Licensed under MIT (https://github.com/vincentdoerig/latex-css/blob/master/LICENSE)
*/

html {
  --bg-color: #F0F0F0;
  --color: black;
  --token-teal: #407f80;
  --token-black: #000000;
  --token-grey: #666666;
  --token-green: #007f00;
  --token-lime: #7d8f29;
  --token-brown: #9a6e3a;
  --token-red: #ba2121;
  --token-fuchsia: #dd4a68;
  --token-orange: #e90;
  --token-pink: #BA6687;
}

html:has(#dark-mode:checked) {
	--bg-color: #2d2d2d;
	--color: #ccc;
	--token-teal: #90D0D0;
	--token-black: #ccc;
	--token-grey: #999;
	--token-green: #51B53F;
	--token-lime: #B4C55D;
	--token-brown: #D3A26B;
	--token-red: #FA5E4F;
	--token-fuchsia: #FF839B;
	--token-orange: #FFCF4C;
	--token-pink: #F49BBC;
}

@media (prefers-color-scheme: dark) {
  html:not(:has(#dark-mode)) {
    --bg-color: #2d2d2d;
    --color: #ccc;
    --token-teal: #90D0D0;
    --token-black: #ccc;
    --token-grey: #999;
    --token-green: #51B53F;
    --token-lime: #B4C55D;
    --token-brown: #D3A26B;
    --token-red: #FA5E4F;
    --token-fuchsia: #FF839B;
    --token-orange: #FFCF4C;
    --token-pink: #F49BBC;
  }
}

code[class*='language-'],
pre[class*='language-'] {
  color: var(--color);
  background: none;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}


/* Code blocks */
pre[class*='language-'] {
  padding: 1em;
  overflow: auto;
}

pre[class*='language-'] {
  background: var(--bg-color);
}

/* Inline code */
:not(pre) > code[class*='language-'] {
  padding: 0.1em;
  border-radius: 0.3em;
  white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
  color: var(--token-teal);
}

.token.punctuation,
.token.constant {
  color: var(--token-black);
}

.token.punctuation.attr-equals,
.token.number,
.token.operator {
  color: var(--token-grey);
}

.token.namespace {
  opacity: 0.7;
}

.token.property,
.token.tag,
.token.boolean,
.token.symbol,
.token.deleted,
.token.keyword {
  color: var(--token-green);
}

.token.selector,
.token.attr-name,
.token.char,
.token.builtin,
.token.inserted {
  color: var(--token-lime);
}

.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
  color: var(--token-brown);
}

.token.atrule,
.token.attr-value,
.token.string,
.token.attr-value .punctuation:not(.attr-equals) {
  color: var(--token-red);
}

.token.class-name {
  color: var(--token-fuchsia);
}

.token.important,
.token.variable {
  color: var(--token-orange);
}

.token.regex {
  color: var(--token-pink);
}

.token.important,
.token.bold {
  font-weight: bold;
}
.token.italic {
  font-style: italic;
}

.token.entity {
  cursor: help;
}


@font-face {
  font-family: 'Temml';
  src: url('temml.woff2') format('woff2');
  font-weight: normal;
  font-style: normal;
}

@font-face {
	font-family: 'Latin Modern Math';
	src: url('/fonts/latinmodern-math.woff2') format('woff2');
}

math {
  font-style: normal;
  font-weight: normal;
  line-height: normal;
  font-size-adjust: none;
  text-indent: 0;
  text-transform: none;
  letter-spacing: normal;
  word-wrap: normal;
  direction: ltr;
  /* Prevent Firefox from omitting the dot on i or j. */
  font-feature-settings: "dtls" off;
}

math * {
  border-color: currentColor;
}

math {
  font-family: "Latin Modern Math", math;
}

/* Next line is active in Firefox and Safari.
 * Not in Chromium, which recognizes display: "block math" written inline. */
math.tml-display { display: block; }

*.mathscr {
  font-family: "Temml";
}

/* Chromium prime alignment */
mo.tml-prime {
  font-family: Temml;
}

/* Prevent f' from overlapping in Chromium */
mo.prime-pad {
  padding-left: 0.08em;
}

/* \cancel & \phase use background images. Get them to print. */
menclose {
  -webkit-print-color-adjust: exact;  /* Chrome & Edge */
          print-color-adjust: exact;
}

/* Array cell justification in Firefox & WebKit */
.tml-right {
  text-align: right;
}
.tml-left {
  text-align: left;
}

/* Styles for Chromium only */
@supports (not (-webkit-backdrop-filter: blur(1px))) and (not (-moz-appearance: none)) {
  /* MathML Core & Chromium do not support the MathML 3.0 element <menclose> attributes. */
  /* So use styles. */
  menclose {
    position: relative;
    padding: 0.5ex 0ex;
  }

    .tml-overline {
    padding: 0.1em 0 0 0;
    border-top: 0.065em solid;
  }

  .tml-underline {
    padding: 0 0 0.1em 0;
    border-bottom: 0.065em solid;
  }

  .tml-cancel {
    display: inline-block;
    position: absolute;
    left: 0.5px;
    bottom: 0;
    width: 100%;
    height: 100%;
    background-color: currentColor;
  }
  .upstrike {
    clip-path: polygon(0.05em 100%, 0em calc(100% - 0.05em), calc(100% - 0.05em) 0em, 100% 0.05em);
  }
  .downstrike {
    clip-path: polygon(0em 0.05em, 0.05em 0em, 100% calc(100% - 0.05em), calc(100% - 0.05em) 100%);
  }
  .sout {
    clip-path: polygon(0em calc(55% + 0.0333em), 0em calc(55% - 0.0333em), 100% calc(55% - 0.0333em), 100% calc(55% + 0.0333em));
  }
  .tml-xcancel {
    background: linear-gradient(to top left,
    rgba(0,0,0,0) 0%,
    rgba(0,0,0,0) calc(50% - 0.06em),
    rgba(0,0,0,1) 50%,
    rgba(0,0,0,0) calc(50% + 0.06em),
    rgba(0,0,0,0) 100%),
    linear-gradient(to top right,
    rgba(0,0,0,0) 0%,
    rgba(0,0,0,0) calc(50% - 0.06em),
    rgba(0,0,0,1) 50%,
    rgba(0,0,0,0) calc(50% + 0.06em),
    rgba(0,0,0,0) 100%)
  }

  .longdiv-top {
    border-top: 0.067em solid;
    padding: 0.1em 0.2em 0.2em 0.433em;
  }
  .longdiv-arc {
    position: absolute;
    top: 0;
    bottom: 0.1em;
    left: -0.4em;
    width: 0.7em;
    border: 0.067em solid;
    transform: translateY(-0.067em);
    border-radius: 70%;
    clip-path: inset(0 0 0 0.4em);
    box-sizing: border-box;}
    .menclose {display: inline-block;
    text-align: left;
    position: relative;
  }

  .phasor-bottom {
    border-bottom: 0.067em solid;
    padding: 0.2em 0.2em 0.1em 0.6em;
  }
  .phasor-angle {
    display: inline-block;
    position: absolute;
    left: 0.5px;
    bottom: -0.04em;
    height: 100%;
    aspect-ratio: 0.5;
    background-color: currentColor;
    clip-path: polygon(0.05em 100%, 0em calc(100% - 0.05em), calc(100% - 0.05em) 0em, 100% 0.05em);
  }

  .tml-box {
    padding: 3pt 0 3pt 0;
    border: 1px solid;
  }
  .tml-fbox {
    padding: 3pt;
    border: 1px solid;
  }

  .circle-pad {
    padding: 0.267em;
  }
  .textcircle {
    position: absolute;
    top: 0;
    bottom: 0;
    right: 0;
    left: 0;
    border: 0.067em solid;
    border-radius: 50%;
   }

   .actuarial {
    padding: 0.03889em 0.03889em 0 0.03889em;
    border-width: 0.08em 0.08em 0em 0em;
    border-style: solid;
    margin-right: 0.03889em;
   }

   /* Stretch \widetilde */
  .tml-crooked-2 {
    transform: scale(2.0, 1.1)
  }
  .tml-crooked-3 {
    transform: scale(3.0, 1.3)
  }
  .tml-crooked-4 {
    transform: scale(4.0, 1.4)
  }
  /* set array cell justification */
  .tml-right {
    text-align: -webkit-right;
  }
  .tml-left {
    text-align: -webkit-left;
  }
}

/* Adjust WebKit accents */
@supports (-webkit-backdrop-filter: blur(1px)) {
  .tml-xshift { transform: translate(0px, 0.45em) }
  .tml-capshift { transform: translate(0px, 0.35em) }
}

/* flex-wrap for line-breaking in Chromium */
math {
  display: inline-flex;
  flex-wrap: wrap;
  align-items: baseline;
}
math > mrow {
  padding: 0.5ex 0ex;
}

/* Avoid flex-wrap in Firefox */
@-moz-document url-prefix() {
  math { display: inline; }
  math > mrow { padding: 0 }
}

/* AMS environment auto-numbering via CSS counter. */
.tml-eqn::before {
  counter-increment: tmlEqnNo;
  content: "(" counter(tmlEqnNo) ")";
}

body {
  counter-reset: tmlEqnNo;
}
/* This is an arbitrary CSS string added to the bundle */
/*!
 * LaTeX.css (https://latex.vercel.app/)
 *
 * Source: https://github.com/vincentdoerig/latex-css
 * Licensed under MIT (https://github.com/vincentdoerig/latex-css/blob/master/LICENSE)
*/

@font-face {
  font-family: 'Latin Modern';
  font-style: normal;
  font-weight: normal;
  font-display: swap;
  src: url('/fonts/lmroman10-regular.woff2') format('woff2');
}

@font-face {
  font-family: 'Latin Modern';
  font-style: italic;
  font-weight: normal;
  font-display: swap;
  src: url('/fonts/lmroman10-italic.woff2') format('woff2');
}

@font-face {
  font-family: 'Latin Modern';
  font-style: normal;
  font-weight: bold;
  font-display: swap;
  src: url('/fonts/lmroman10-bold.woff2') format('woff2');
}

@font-face {
  font-family: 'Latin Modern';
  font-style: italic;
  font-weight: bold;
  font-display: swap;
  src: url('/fonts/lmroman10-bolditalic.woff2') format('woff2');
}

@font-face {
	font-family: 'Latin Modern Small Caps';
	font-style: normal;
	font-weight: normal;
	font-feature-settings: "smcp";
	font-display: swap;
	src: url('/fonts/lmromancaps10-regular.woff2') format('woff2');
}

@font-face {
	font-family: 'Latin Modern Small Caps';
	font-style: italic;
	font-weight: normal;
	font-feature-settings: "smcp";
	font-display: swap;
	src: url('/fonts/lmromancaps10-oblique.woff2') format('woff2');
}

@font-face {
  font-family: 'Latin Modern Sans';
  font-style: normal;
  font-weight: normal;
  font-display: swap;
  src: url('/fonts/lmsans10-regular.woff2') format('woff2');
}

@font-face {
  font-family: 'Latin Modern Sans';
  font-style: italic;
  font-weight: normal;
  font-display: swap;
  src: url('/fonts/lmsans10-oblique.woff2') format('woff2');
}

@font-face {
  font-family: 'Latin Modern Sans';
  font-style: normal;
  font-weight: bold;
  font-display: swap;
  src: url('/fonts/lmsans10-bold.woff2') format('woff2');
}

@font-face {
  font-family: 'Latin Modern Sans';
  font-style: italic;
  font-weight: bold;
  font-display: swap;
  src: url('/fonts/lmsans10-boldoblique.woff2') format('woff2');
}

@font-face {
	font-family: 'Latin Modern Mono';
	font-style: normal;
	font-weight: normal;
	font-display: swap;
	src: url('/fonts/lmmono10-regular.woff2') format('woff2');
}

@font-face {
	font-family: 'Latin Modern Mono';
	font-style: italic;
	font-weight: normal;
	font-display: swap;
	src: url('/fonts/lmmono10-italic.woff2') format('woff2');
}

/* Box sizing rules */
*,
*::before,
*::after {
  box-sizing: border-box;
}

html {
  --body-color: hsl(0, 5%, 10%);
  --body-bg-color: hsl(210, 20%, 98%);
  --link-visited: hsl(0, 100%, 33%);
  --link-focus-outline: hsl(220, 90%, 52%);
  --pre-bg-color: hsl(210, 28%, 93%);
  --kbd-bg-color: hsl(210, 5%, 100%);
  --kbd-border-color: hsl(210, 5%, 70%);
  --table-border-color: black;
  --border-width-thin: 1.36px;
  --border-width-thick: 2.27px;
  --sidenote-target-border-color: hsl(55, 55%, 70%);
  --footnotes-border-color: hsl(0, 0%, 39%);
  --text-indent-size: 1.17rem;
}

html:has(#dark-mode:checked) {
	--body-color: hsl(0, 0%, 86%);
	--body-bg-color: hsl(0, 0%, 16%);
	--link-visited: hsl(196 80% 77%);
	--link-focus-outline: hsl(215, 63%, 73%);
	--pre-bg-color: hsl(0, 1%, 25%);
	--kbd-bg-color: hsl(0, 0%, 16%);
	--kbd-border-color: hsl(210, 5%, 70%);
	--table-border-color: white;
	--sidenote-target-border-color: hsl(0, 0%, 59%);
	--footnotes-border-color: hsl(0, 0%, 59%);
	--proof-symbol-filter: invert(80%);
}

@media (prefers-color-scheme: dark) {
	html:not(:has(#dark-mode)) {
		--body-color: hsl(0, 0%, 86%);
		--body-bg-color: hsl(0, 0%, 16%);
		--link-visited: hsl(196 80% 77%);
		--link-focus-outline: hsl(215, 63%, 73%);
		--pre-bg-color: hsl(0, 1%, 25%);
		--kbd-bg-color: hsl(0, 0%, 16%);
		--kbd-border-color: hsl(210, 5%, 70%);
		--table-border-color: white;
		--sidenote-target-border-color: hsl(0, 0%, 59%);
		--footnotes-border-color: hsl(0, 0%, 59%);
		--proof-symbol-filter: invert(80%);
	}
}

/* Remove default margin */
body,
h1,
h2,
h3,
h4,
p,
ul[class],
ol[class],
li,
figure,
figcaption,
dl,
dd {
  margin: 0;
}

/* Make default font-size 20px for easier reading */
html {
  font-size: 20px;
}

/* add smooth scrolling to anchors */
@media (prefers-reduced-motion: no-preference) {
  html {
    scroll-behavior: smooth;
  }
}

body {
  font-family: 'Latin Modern', Georgia, Cambria, 'Times New Roman', Times, serif;
  line-height: 1.8;

  max-width: 80ch;
  min-height: 100vh;
  overflow-x: hidden;
  margin: 0 auto;
  padding: 1.6rem 1rem;

  counter-reset: theorem definition sidenote-counter equation;

  color: var(--body-color);
  background-color: var(--body-bg-color);

  text-rendering: optimizeLegibility;
}

h1, h2, h3, h4, h5, h6, h7, h8, h9 {
  font-family: 'Latin Modern Sans', Helvetica, 'Trebuchet MS', sans-serif;
  font-weight: normal;
  text-wrap: balance;
}

/* Justify and hyphenate all paragraphs */
p {
  text-align: justify;
  hyphens: auto;
  -webkit-hyphens: auto;
  -moz-hyphens: auto;
  margin-top: 1rem;
}

p:first-child {
	margin-top: 0;
}

/* Indents paragraphs like in LaTeX documents*/
.indent-pars p {
  text-indent: var(--text-indent-size);
}

.indent-pars p.no-indent,
p.no-indent {
  text-indent: 0;
}

.indent-pars ol p,
.indent-pars ul p {
  text-indent: 0;
}

.indent-pars h2 + p,
.indent-pars h3 + p,
.indent-pars h4 + p {
  text-indent: 0;
}

/* A elements that don't have a class get default styles */
a:not([class]) {
  text-decoration-skip-ink: auto;
}

/* Make links red */
a,
a:visited {
  color: var(--link-visited);
}

a:focus {
  outline-offset: 2px;
  outline: 2px solid var(--link-focus-outline);
}

/* Make images easier to work with */
img {
  max-width: 100%;
  height: auto;
  display: block;
}

/* Inherit fonts for inputs and buttons */
input,
button,
textarea,
select {
  font: inherit;
}

/* Prevent textarea from overflowing */
textarea {
  width: 100%;
}

/* Natural flow and rhythm in articles by default */
article > * + * {
  margin-top: 1em;
}

/* Styles for inline code or code snippets */
code,
pre,
kbd {
  font-family: 'Latin Modern Mono', Menlo, Monaco, Consolas, 'Courier New',
    monospace;
  font-size: 85%;
  hyphens: none;
}
pre {
  padding: 1rem 1.4rem;
  max-width: 100%;
  overflow: auto;
  border-radius: 4px;
  background: var(--pre-bg-color);
	line-height: 1.5;
}
pre code {
  font-size: 95%;
  position: relative;
}
kbd {
  background: var(--kbd-bg-color);
  border: 1px solid var(--kbd-border-color);
  border-radius: 2px;
  padding: 2px 4px;
  font-size: 75%;
}

/* Better tables */
table {
  border-collapse: collapse;
  border-spacing: 0;
  width: 100%;
  border-top: var(--border-width-thick) solid var(--table-border-color);
  border-bottom: var(--border-width-thick) solid var(--table-border-color);
  overflow-x: auto; /* does not work because element is not block */
  counter-increment: caption;
}
table:has(caption) {
	border-top: none;
}

/* add bottom border on column table headings  */
table tr > th[scope='col'] {
  border-bottom: var(--border-width-thin) solid var(--table-border-color);
}
/* add right border on row table headings  */
table tr > th[scope='row'] {
  border-right: var(--border-width-thin) solid var(--table-border-color);
}
table > tbody > tr:first-child > td,
table > tbody > tr:first-child > th {
  border-top: var(--border-width-thin) solid var(--table-border-color);
}
table > tbody > tr:last-child > td,
table > tbody > tr:last-child > th {
  border-bottom: var(--border-width-thin) solid var(--table-border-color);
}

th,
td {
  text-align: left;
  padding: 0.5rem;
  line-height: 1.1;
}
/* Table caption */
caption {
  text-align: left;
  font-size: 0.923em;
  border-bottom: var(--border-width-thick) solid var(--table-border-color);
  padding: 0 0.25em 0.25em;
  width: 100%;
  margin-left: 0;
	line-height: 1.3;
}

caption::before {
  content: 'Table ' counter(caption) '. ';
  font-weight: bold;
}

/* allow scroll on the x-axis */
.scroll-wrapper {
  overflow-x: auto;
}

/* if a table is wrapped in a scroll wrapper,
  the table cells shouldn't wrap */
.scroll-wrapper > table td {
  white-space: nowrap;
}

/* Format figure captions (based on table captions) */
figure {
  counter-increment: figcaption;
	margin-top: 1rem;
}
figcaption {
  text-align: left;
  font-size: 0.9rem;
  width: 100%;
  margin-left: 0;
  line-height: 1.3;
}
figcaption::before {
  content: 'Figure ' counter(figcaption) '. ';
  font-weight: bold;
}

/* Center align the title */
h1:first-child {
  /* text-align: center; */
}

/* Nested ordered list for ToC */
nav ol {
  counter-reset: item;
  padding-left: 2rem;
}
nav ol li {
  display: block;
}
nav ol li::before {
  content: counters(item, '.') ' ';
  counter-increment: item;
  padding-right: 0.85rem;
}

/* Center definitions (most useful for display equations) */
dl dd {
  text-align: center;
}

/* Theorem */
.theorem {
  counter-increment: theorem;
  display: block;
  margin: 12px 0;
  font-style: italic;
}
.theorem::before {
  content: 'Theorem ' counter(theorem) '. ';
  font-weight: bold;
  font-style: normal;
}

/* Lemma */
.lemma {
  counter-increment: theorem;
  display: block;
  margin: 12px 0;
  font-style: italic;
}
.lemma::before {
  content: 'Lemma ' counter(theorem) '. ';
  font-weight: bold;
  font-style: normal;
}

/* Proof */
.proof {
  display: block;
  margin: 12px 0;
  font-style: normal;
  position: relative;
}
.proof::before {
  content: 'Proof. ' attr(title);
  font-style: italic;
}
.proof::after {
  content: '◾️';
  filter: var(--proof-symbol-filter);
  position: absolute;
  right: -12px;
  bottom: -2px;
}

/* Definition */
.definition {
  counter-increment: definition;
  display: block;
  margin: 12px 0;
  font-style: normal;
}
.definition::before {
  content: 'Definition ' counter(definition) '. ';
  font-weight: bold;
  font-style: normal;
}

/* Center align author name, use small caps and add vertical spacing  */
.author {
  margin: 0.85rem 0;
  font-variant-caps: small-caps;
  /* text-align: center; */
}

/* Sidenotes */

.sidenote {
  font-size: 0.8rem;
  float: right;
  clear: right;
  width: 18vw;
  margin-right: -20vw;
  margin-bottom: 1em;
  text-indent: 0;
  line-height: 1.3;
}

.sidenote.left {
  float: left;
  margin-left: -20vw;
  margin-bottom: 1em;
  text-indent: 0;
}

/* (WIP) add border when a sidenote is clicked on */
.sidenote:target {
  border: var(--sidenote-target-border-color) 1.5px solid;
  padding: 0 .5rem;
  scroll-margin-block-start: 10rem;
}

/* sidenote counter */
.sidenote-number {
  counter-increment: sidenote-counter;
}

.sidenote-number::after,
.sidenote::before {
  position: relative;
  vertical-align: baseline;
}

/* add number in main content */
.sidenote-number::after {
  content: counter(sidenote-counter);
  font-size: 0.7rem;
  top: -0.5rem;
  left: 0.1rem;
}

/* add number in front of the sidenote */
.sidenote-number ~ .sidenote::before {
  content: counter(sidenote-counter) ' ';
  font-size: 0.7rem;
  top: -0.5rem;
}

label.sidenote-toggle:not(.sidenote-number) {
  display: none;
}

/* sidenotes inside blockquotes are indented more */
blockquote .sidenote {
  margin-right: -24vw;
  width: 18vw;
}


label.sidenote-toggle {
  display: inline;
}

input.sidenote-toggle {
  display: none;
}

@media (max-width: 1050px) {
	label.sidenote-toggle {
		cursor: pointer;
	}
  label.sidenote-toggle:not(.sidenote-number) {
    display: inline;
  }
  .sidenote {
    display: none;
  }
  .sidenote-toggle:checked + .sidenote {
    display: block;
    margin: 0.5rem 1.25rem 1rem 0.5rem;
    float: left;
    left: 1rem;
    clear: both;
    width: 95%;
  }
  /* tweak indentation of sidenote inside a blockquote */
  blockquote .sidenote {
    margin-right: -25vw;
    width: 16vw;
  }
}

/* Make footnote text smaller and left align it (looks bad with long URLs) */
.footnotes p {
  text-align: left;
  line-height: 1.5;
  font-size: 85%;
  margin-bottom: 0.4rem;
}
.footnotes {
  border-top: 1px solid var(--footnotes-border-color);
}

/* Center title and paragraph */
.abstract,
.abstract p {
  /* text-align: center; */
  margin-top: 0;
}
.abstract {
  margin: 2.25rem 0;
}
.abstract > h2 {
  font-size: 1rem;
  margin-bottom: -0.2rem;
}

h1 {
  font-size: 1.7rem;
  line-height: 2rem;
  margin-bottom: 2rem;
}

h1:first-child {
	margin-bottom: 0.5rem;
}

h2 {
  font-size: 1.4rem;
  margin-top: 2.5rem;
}

h3 {
  font-size: 1.2rem;
  margin-top: 2rem;
}

h4 {
  font-size: 1rem;
  margin-top: 1.8rem;
}

h5 {
  font-size: 1rem;
  font-style: italic;
  font-weight: normal;
  margin-top: 2.5rem;
}

h2,
h4,
h5,
h6 {
  line-height: 1.625rem;
}

h1 + h2 {
  margin-top: 1.625rem;
}

h2 + h3,
h3 + h4,
h4 + h5 {
  margin-top: 0.8rem;
}

h5 + h6 {
  margin-top: -0.8rem;
}

h2,
h3,
h4,
h5,
h6 {
  margin-bottom: 0.8rem;
}

/* Custom additions */

@media (max-width: 800px) {
	body {
		line-height: 1.5;
	}
}

/* https://www.a11yproject.com/posts/how-to-hide-content/ */
.visually-hidden {
	clip: rect(0 0 0 0);
	clip-path: inset(50%);
	height: 1px;
	overflow: hidden;
	position: absolute;
	white-space: nowrap;
	width: 1px;
}

/* Header */
header {
	display: flex;
	gap: 1em .5em;
	flex-wrap: wrap;
	align-items: center;
	margin-bottom: 2rem;
}
.home-link {
	font-size: 1em; /* 16px /16 */
	font-weight: 700;
	margin-right: 2em;
}
.home-link:link:not(:hover) {
	text-decoration: none;
}

/* Nav */
.nav {
	display: flex;
	gap: 1.75rem;
	padding: 0;
	margin: 0;
	list-style: none;
}
.nav-item {
	display: inline-block;
}
.nav-item a {
	text-decoration: none;
}

/* Posts list */
.postlist {
	list-style: none;
	padding: 0;
	padding-left: 1.5rem;
}
.postlist-item {
	display: flex;
	flex-wrap: wrap;
	align-items: baseline;
	counter-increment: start-from -1;
	margin-bottom: 1em;
}
.postlist-item:before {
	display: inline-block;
	pointer-events: none;
	content: "" counter(start-from, decimal-leading-zero) ". ";
	line-height: 100%;
	text-align: right;
	margin-left: -1.5rem;
}
.postlist-date,
.postlist-item:before {
	font-size: 0.8125em; /* 13px /16 */
}
.postlist-date {
	word-spacing: -0.5px;
}
.postlist-link {
	font-size: 1.1875em; /* 19px /16 */
	font-weight: 700;
	flex-basis: calc(100% - 1.5rem);
	padding-left: .25em;
	padding-right: .5em;
	text-underline-position: from-font;
	text-underline-offset: 0;
	text-decoration-thickness: 1px;
}
.postlist-item-active .postlist-link {
	font-weight: bold;
}

/* Tags */
.post-tag {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	text-transform: capitalize;
	font-style: italic;
}
.postlist-item > .post-tag {
	align-self: center;
}

/* Tags list */
.post-metadata {
	display: inline-flex;
	flex-wrap: wrap;
	gap: .5em;
	list-style: none;
	padding: 0;
	margin: 0;
}
.post-metadata time {
	margin-right: 1em;
}

.nav-name {
	font-size: 1.5rem;
	line-height: 1;
	margin-top: 0;
	margin-left: 1.5rem;
}

.mode-switch {
	margin-left: auto;
}

.mode-switch label {
	cursor: pointer;
}

.light-mode-hide {
	display: none
}

html:has(#dark-mode:checked) {
	.dark-mode-hide {
		display: none;
	}
	.light-mode-hide {
		display: initial;
	}
}

/* Equation numbering */
.tml-block {
	position: relative;
}
.tml-block::after {
	counter-increment: equation;
	content: "(" counter(equation) ")";
	position: absolute;
	right: 0;
	top: calc(50% - 1em);
}

/* Figures with two images are light/dark mode versions. Note
   that the <img> element is encapsulated in a <p> by 11ty.
   If there's only one image (e.g. a photograph) adjust the
   brightness.
 */

figure:has(p:nth-child(2)) > p:nth-child(2) {
	display: none;
}

html:has(#dark-mode:checked) {
	figure:has(p:nth-child(2)) > p:nth-child(1) {
		display: none;
	}
	figure:has(p:nth-child(2)) > p:nth-child(2) {
		display: block;
	}
	figure p:only-of-type img {
		filter: brightness(.8) contrast(1.2);
	}
}

@media (prefers-color-scheme: dark) {
	html:not(:has(#dark-mode)) {
		figure:has(p:nth-child(2)) > p:nth-child(1) {
			display: none;
		}
		figure:has(p:nth-child(2)) > p:nth-child(2) {
			display: block;
		}
		figure p:only-of-type img {
			filter: brightness(.8) contrast(1.2);
		}
	}
}

table {
	margin-top: 1rem;
}

footer {
	margin-top: 3.5rem;
}

.a--icon, .a--icon:visited
{
	color: var(--body-color);
	display: inline-flex;
}

.a--icon:hover, .a--icon:active {
	color: var(--link-visited);
}

.icon, .icon svg {
	height: 1.5rem;
	width: 1.5rem;
}

abbr {
	font-family: 'Latin Modern Small Caps', 'Latin Modern', Georgia, Cambria, 'Times New Roman', Times, serif;
	font-variant: small-caps;
	text-transform: lowercase;
}</style>
	</head>
	<body>
		<a href="#skip" class="visually-hidden">Skip to main content</a>

		<header>
			<nav>
				<h2 class="visually-hidden" id="top-level-navigation-menu">Top level navigation menu</h2>
				<ul class="nav">
					<li class="nav-item"><a class="a--icon" href="/">
						<span class="icon">
<svg viewBox="0 0 180 180" xmlns="http://www.w3.org/2000/svg">
  <title>Home page</title>
  <path d="M 43.334 144.444 L 66.667 144.444 L 66.667 97.778 L 113.334 97.778 L 113.334 144.444 L 136.667 144.444 L 136.667 74.444 L 90 39.444 L 43.334 74.444 L 43.334 144.444 Z M 27.778 160 L 27.778 66.667 L 90 20 L 152.222 66.667 L 152.222 160 L 97.778 160 L 97.778 113.333 L 82.222 113.333 L 82.222 160 L 27.778 160 Z M 90 91.944 Z" fill="currentColor"></path>
</svg>
</span>
					</a></li>
					<li class="nav-item"><a class="a--icon" href="/about/">
						<span class="icon">
<svg viewBox="0 0 180 180" xmlns="http://www.w3.org/2000/svg">
  <title>About me</title>
  <path d="M 90 90 C 80.375 90 72.135 86.573 65.281 79.719 C 58.427 72.865 55 64.625 55 55 C 55 45.375 58.427 37.135 65.281 30.281 C 72.135 23.427 80.375 20 90 20 C 99.625 20 107.865 23.427 114.719 30.281 C 121.573 37.135 125 45.375 125 55 C 125 64.625 121.573 72.865 114.719 79.719 C 107.865 86.573 99.625 90 90 90 Z M 20 160 L 20 135.5 C 20 130.542 21.276 125.984 23.828 121.828 C 26.38 117.672 29.771 114.5 34 112.313 C 43.042 107.792 52.229 104.401 61.563 102.141 C 70.896 99.88 80.375 98.75 90 98.75 C 99.625 98.75 109.104 99.88 118.438 102.141 C 127.771 104.401 136.958 107.792 146 112.313 C 150.229 114.5 153.62 117.672 156.172 121.828 C 158.724 125.984 160 130.542 160 135.5 L 160 160 L 20 160 Z M 37.5 142.5 L 142.5 142.5 L 142.5 135.5 C 142.5 133.896 142.099 132.438 141.297 131.125 C 140.495 129.813 139.438 128.792 138.125 128.063 C 130.25 124.125 122.302 121.172 114.281 119.203 C 106.26 117.234 98.167 116.25 90 116.25 C 81.833 116.25 73.74 117.234 65.719 119.203 C 57.698 121.172 49.75 124.125 41.875 128.063 C 40.563 128.792 39.505 129.813 38.703 131.125 C 37.901 132.438 37.5 133.896 37.5 135.5 L 37.5 142.5 Z M 90 72.5 C 94.813 72.5 98.932 70.786 102.359 67.359 C 105.786 63.932 107.5 59.813 107.5 55 C 107.5 50.188 105.786 46.068 102.359 42.641 C 98.932 39.214 94.813 37.5 90 37.5 C 85.188 37.5 81.068 39.214 77.641 42.641 C 74.214 46.068 72.5 50.188 72.5 55 C 72.5 59.813 74.214 63.932 77.641 67.359 C 81.068 70.786 85.188 72.5 90 72.5 Z M 90 55 Z M 90 142.5 Z" fill="currentColor"></path>
</svg>
</span>
					</a></li>
				</ul>
			</nav>
			<h2 class="nav-name" id="stephen-thomas">Stephen Thomas</h2>
			
			
		</header>

		<main id="skip">
			
<h1 id="arbitrary-statistical-models">Arbitrary Statistical Models</h1>

<ul class="post-metadata">
	<li><time datetime="2025-01-20">20 January 2025</time></li>
	<li><a href="/tags/software/" class="post-tag">software</a>, </li>
	<li><a href="/tags/stata/" class="post-tag">stata</a>, </li>
	<li><a href="/tags/statistics/" class="post-tag">statistics</a>, </li>
	<li><a href="/tags/bayes/" class="post-tag">bayes</a></li>
</ul>

<p>This post might be the only time <a href="https://www.stata.com">Stata</a> code appears on the blog. Most of the software I share here will be written in a freely available language such as Python. But I’ve had these notes tucked away for awhile, and someone else may find them useful. Even long-time Stata users might be unaware of its versatility for developing arbitrary statistical models. We can see that flexibility by analyzing the same data set using non-linear regression, maximum likelihood estimation, and Bayesian analysis.</p>
<p>Here is the initialization code that I typically use for all Stata scripts<label for="sn-1" class="sidenote-toggle sidenote-number"></label>
<input type="checkbox" id="sn-1" class="sidenote-toggle">
<span class="sidenote">Experienced Stata users will note that I do not follow the normal convention of abbreviating commands and options. I find code much less confusing when they are spelled out in full.</span>. The <code>version</code> command is one of my favorites. It directs Stata to execute the remainder of the script as if it were the specified Stata version. In this case I’m using version 18. In the future when newer Stata versions are available, this command will tell the application not to use updated versions of alogrithms and equations. This feature is a big help for reproducibility.</p>
<pre class="language-stata" tabindex="0"><code class="language-stata"><span class="token command keyword">version</span> <span class="token number">18</span>          <span class="token comment">// Stata version used to create/execute this script</span>
<span class="token command keyword">set</span> more <span class="token boolean">off</span>        <span class="token comment">// disable pause of output display every full screen</span>
<span class="token command keyword">clear</span> all           <span class="token comment">// ensure clean slate</span>
<span class="token keyword">capture</span> <span class="token command keyword">log</span> close   <span class="token comment">// close any pending logs</span>
<span class="token command keyword">set</span> seed <span class="token number">123456789</span>  <span class="token comment">// consistent random number generation</span></code></pre>
<p>For this analysis I’ll reuse a commonly cited <a href="https://chjackson.github.io/openbugsdoc/Examples/Dugongs.html">example</a> from the now-retired OpenBUGS software. The data are length and age measurements for 27 captured dugongs (sea cows)<label for="sn-2" class="sidenote-toggle sidenote-number"></label>
<input type="checkbox" id="sn-2" class="sidenote-toggle">
<span class="sidenote">Ratkowsky, David A.. <em>Nonlinear Regression Modeling: A Unified Practical Approach.</em> Switzerland, M. Dekker, 1983.</span>. Carlin and Gelfand (1991)<label for="sn-3" class="sidenote-toggle sidenote-number"></label><input type="checkbox" id="sn-3" class="sidenote-toggle"><span class="sidenote">Carlin, B. P., and A. E. Gelfand. “An iterative Monte Carlo method for nonconjugate Bayesian analysis.” <em>Statistics and Computing,</em> vol. 1, no. 2, Dec. 1991, pp. 119–28. Scopus, doi:10.1007/BF01889986.</span> model the data from this example using a simple nonlinear growth curve that increases rapidly at early ages and tends to an asymptote as the age increases. In simple form, <math><mrow><mi>y</mi><mo>=</mo></mrow><mrow><mi>α</mi><mo>−</mo></mrow><mrow><mi>β</mi><mo>⋅</mo></mrow><mrow><msup><mi>λ</mi><mi>x</mi></msup></mrow></math>, where <math><mi>y</mi></math> starts at <math><mrow><mi>α</mi><mo>−</mo></mrow><mrow><mi>β</mi></mrow></math> when <math><mrow><mi>x</mi><mo>=</mo></mrow><mrow><mn>0</mn></mrow></math> and, provided <math><mrow><mi>λ</mi><mo>&lt;</mo></mrow><mrow><mn>1</mn></mrow></math>, asymptotically approaches <math><mi>α</mi></math>. Equation 1 describes the model more formally; in particular we assume that any errors in the data are normally distributed with zero mean and an unknown standard deviation.</p>
<p class="tml-block"><math display="block" class="tml-display" style="display:block math;"><mrow><mi>y</mi><mo>∼</mo><mi>α</mi><mo>−</mo><mi>β</mi><mo>⋅</mo><msup><mi>λ</mi><mi>x</mi></msup><mo>+</mo><mtext>N</mtext><mo form="prefix" stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo form="postfix" stretchy="false">)</mo></mrow></math></p>
<p>We’ll use that same model for all the examples that follow. As a check for the results that we get from Stata, a simple. model in <a href="https://mc-stan.org">Stan</a> provides what I consider the “gold standard” for estimates of model parameters. Table 1 details the parameter estimates from this model.</p>
<pre class="language-stan" tabindex="0"><code class="language-stan"><span class="token keyword program-block">data</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span><span class="token constraint"><span class="token punctuation">&lt;</span><span class="token property">lower</span><span class="token operator">=</span><span class="token expression"><span class="token number">0</span></span><span class="token punctuation">></span></span> N<span class="token punctuation">;</span>
        <span class="token keyword">array</span><span class="token punctuation">[</span>N<span class="token punctuation">]</span> <span class="token keyword">real</span><span class="token constraint"><span class="token punctuation">&lt;</span><span class="token property">lower</span><span class="token operator">=</span><span class="token expression"><span class="token number">0</span></span><span class="token punctuation">></span></span> x<span class="token punctuation">;</span>
        <span class="token keyword">array</span><span class="token punctuation">[</span>N<span class="token punctuation">]</span> <span class="token keyword">real</span><span class="token constraint"><span class="token punctuation">&lt;</span><span class="token property">lower</span><span class="token operator">=</span><span class="token expression"><span class="token number">0</span></span><span class="token punctuation">></span></span> y<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword program-block">parameters</span> <span class="token punctuation">{</span>
        <span class="token keyword">real</span> alpha<span class="token punctuation">;</span>
        <span class="token keyword">real</span> beta<span class="token punctuation">;</span>
        <span class="token keyword">real</span><span class="token constraint"><span class="token punctuation">&lt;</span><span class="token property">lower</span><span class="token operator">=</span><span class="token expression"><span class="token number">.5</span></span><span class="token punctuation">,</span> <span class="token property">upper</span><span class="token operator">=</span> <span class="token expression"><span class="token number">1</span></span><span class="token punctuation">></span></span> lamda<span class="token punctuation">;</span>
        <span class="token keyword">real</span><span class="token constraint"><span class="token punctuation">&lt;</span><span class="token property">lower</span><span class="token operator">=</span><span class="token expression"><span class="token number">0</span></span><span class="token punctuation">></span></span> sigma<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword program-block">transformed</span> <span class="token keyword program-block">parameters</span> <span class="token punctuation">{</span>
        <span class="token keyword">array</span><span class="token punctuation">[</span>N<span class="token punctuation">]</span> <span class="token keyword">real</span> m<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span>N<span class="token punctuation">)</span>
            m<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> alpha <span class="token operator">-</span> beta <span class="token operator">*</span> <span class="token function">pow</span><span class="token punctuation">(</span>lamda<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword program-block">model</span> <span class="token punctuation">{</span>
        <span class="token comment">// priors</span>
        alpha <span class="token operator">~</span> <span class="token function">normal</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        beta  <span class="token operator">~</span> <span class="token function">normal</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        lamda <span class="token operator">~</span> <span class="token function">uniform</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sigma <span class="token operator">~</span> <span class="token function">inv_gamma</span><span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// likelihood</span>
        y <span class="token operator">~</span> <span class="token function">normal</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> sigma<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<table>
<caption>Parameter estimates from Stan</caption>
<thead>
<tr>
<th></th>
<th>Mean</th>
<th><abbr>MCSE</abbr></th>
<th>StdDev</th>
<th>5%</th>
<th>50%</th>
<th>95%</th>
</tr>
</thead>
<tbody>
<tr>
<td>alpha</td>
<td>2.7</td>
<td>3.5×10<sup>-3</sup></td>
<td>0.069</td>
<td>2.6</td>
<td>2.6</td>
<td>2.8</td>
</tr>
<tr>
<td>beta</td>
<td>0.97</td>
<td>3.2×10<sup>-3</sup></td>
<td>0.072</td>
<td>0.85</td>
<td>0.97</td>
<td>1.1</td>
</tr>
<tr>
<td>lambda</td>
<td>0.86</td>
<td>1.6×10<sup>-3</sup></td>
<td>0.031</td>
<td>0.81</td>
<td>0.87</td>
<td>0.91</td>
</tr>
<tr>
<td>Sigma</td>
<td>0.099</td>
<td>7.2×10<sup>-4</sup></td>
<td>0.015</td>
<td>0.078</td>
<td>0.097</td>
<td>0.12</td>
</tr>
</tbody>
</table>
<p>Now we can turn to Stata. For reproducibility I’ll show the full data set as it’s loaded into Stata.</p>
<pre class="language-stata" tabindex="0"><code class="language-stata"><span class="token command keyword">quietly</span> <span class="token punctuation">{</span>
    <span class="token command keyword">input</span> x y
         <span class="token number">1</span>    <span class="token number">1.8</span>
         <span class="token number">1.5</span>  <span class="token number">1.85</span>
         <span class="token number">1.5</span>  <span class="token number">1.87</span>
         <span class="token number">1.5</span>  <span class="token number">1.77</span>
         <span class="token number">2.5</span>  <span class="token number">2.02</span>
         <span class="token number">4</span>    <span class="token number">2.27</span>
         <span class="token number">5</span>    <span class="token number">2.15</span>
         <span class="token number">5</span>    <span class="token number">2.26</span>
         <span class="token number">7</span>    <span class="token number">2.47</span>
         <span class="token number">8</span>    <span class="token number">2.19</span>
         <span class="token number">8.5</span>  <span class="token number">2.26</span>
         <span class="token number">9</span>    <span class="token number">2.4</span>
         <span class="token number">9.5</span>  <span class="token number">2.39</span>
         <span class="token number">9.5</span>  <span class="token number">2.41</span>
        <span class="token number">10</span>    <span class="token number">2.5</span>
        <span class="token number">12</span>    <span class="token number">2.32</span>
        <span class="token number">12</span>    <span class="token number">2.32</span>
        <span class="token number">13</span>    <span class="token number">2.43</span>
        <span class="token number">13</span>    <span class="token number">2.47</span>
        <span class="token number">14.5</span>  <span class="token number">2.56</span>
        <span class="token number">15.5</span>  <span class="token number">2.65</span>
        <span class="token number">15.5</span>  <span class="token number">2.47</span>
        <span class="token number">16.5</span>  <span class="token number">2.64</span>
        <span class="token number">17</span>    <span class="token number">2.56</span>
        <span class="token number">22.5</span>  <span class="token number">2.7</span>
        <span class="token number">29</span>    <span class="token number">2.72</span>
        <span class="token number">31.5</span>  <span class="token number">2.57</span>
    <span class="token command keyword">end</span>
<span class="token punctuation">}</span></code></pre>
<p>The Stata algorithms need initial guesses for the model parameters, so here’s what we’ll use. We could theoretically pick any values here, but the code will run much quicker if the guesses are at least in the ball park.</p>
<pre class="language-stata" tabindex="0"><code class="language-stata"><span class="token command keyword">local</span> alpha <span class="token operator">=</span> <span class="token number">1</span>
<span class="token command keyword">local</span> beta  <span class="token operator">=</span> <span class="token number">1</span>
<span class="token command keyword">local</span> lamda <span class="token operator">=</span> <span class="token number">0.9</span></code></pre>
<h2 id="non-linear-least-squares">Non-Linear Least Squares</h2>
<p>A simple approach for finding parameter values is non-linear least squares with Stata’s <code>nl</code> command. It makes assumptions that are not always appropriate (e.g. errors are normally distributed) but even when those assumptions don’t hold, the approach may be helpful as a first step. The <code>nl</code> results can provide good initial values and, potential estimates for the error variance. The simplest way to use <code>nl</code> is with expressions.</p>
<pre class="language-stata" tabindex="0"><code class="language-stata"><span class="token command keyword">nl</span> <span class="token punctuation">(</span>y <span class="token operator">=</span> <span class="token punctuation">{</span>alpha<span class="token punctuation">}</span> <span class="token operator">-</span> <span class="token punctuation">{</span>beta<span class="token punctuation">}</span> <span class="token operator">*</span> <span class="token punctuation">{</span>lamda<span class="token punctuation">}</span> <span class="token operator">^</span> x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">///</span>
    <span class="token command keyword">initial</span><span class="token punctuation">(</span>alpha <span class="token variable">`alpha'</span> beta <span class="token variable">`beta'</span> lamda <span class="token variable">`lamda'</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">nolog</span></code></pre>
<p>Although not necessary for this example, more complicated models may be implemented as “programs.”</p>
<p>Stata requires programs used for non-linear least squares to have a name that starts with “nl.” That prefix is then omitted when the program is referenced in the actual <code>nl</code> command.</p>
<pre class="language-stata" tabindex="0"><code class="language-stata"><span class="token keyword">capture</span> <span class="token command keyword">program</span> drop nlgrowth
<span class="token command keyword">program</span> define nlgrowth
    <span class="token command keyword">syntax</span> <span class="token keyword">varlist</span><span class="token punctuation">(</span>min<span class="token operator">=</span><span class="token number">2</span> max<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">,</span> <span class="token function">at</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    <span class="token command keyword">local</span> y<span class="token punctuation">:</span> word <span class="token number">1</span> <span class="token keyword">of</span> <span class="token variable">`varlist'</span>
    <span class="token command keyword">local</span> x<span class="token punctuation">:</span> word <span class="token number">2</span> <span class="token keyword">of</span> <span class="token variable">`varlist'</span>
    <span class="token command keyword">tempname</span> alpha beta lamda
    <span class="token command keyword">scalar</span> <span class="token variable">`alpha'</span> <span class="token operator">=</span> <span class="token variable">`at'</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token command keyword">scalar</span> <span class="token variable">`beta'</span>  <span class="token operator">=</span> <span class="token variable">`at'</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
    <span class="token command keyword">scalar</span> <span class="token variable">`lamda'</span> <span class="token operator">=</span> <span class="token variable">`at'</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
    <span class="token command keyword">replace</span> <span class="token variable">`y'</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">`alpha'</span> <span class="token operator">-</span> <span class="token variable">`beta'</span> <span class="token operator">*</span> <span class="token variable">`lamda'</span> <span class="token operator">^</span> <span class="token variable">`x'</span><span class="token punctuation">)</span> <span class="token variable">`if'</span>
<span class="token command keyword">end</span>

<span class="token command keyword">nl</span> growth @ y x<span class="token punctuation">,</span> <span class="token comment">///</span>
    <span class="token command keyword">parameters</span><span class="token punctuation">(</span>alpha beta lamda<span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">initial</span><span class="token punctuation">(</span>alpha <span class="token variable">`alpha'</span> beta <span class="token variable">`beta'</span> lamda <span class="token variable">`lamda'</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">nolog</span>

<span class="token command keyword">local</span> alpha_nl <span class="token operator">=</span> _b<span class="token punctuation">[</span><span class="token operator">/</span>alpha<span class="token punctuation">]</span>
<span class="token command keyword">local</span> beta_nl  <span class="token operator">=</span> _b<span class="token punctuation">[</span><span class="token operator">/</span>beta<span class="token punctuation">]</span>
<span class="token command keyword">local</span> lamda_nl <span class="token operator">=</span> _b<span class="token punctuation">[</span><span class="token operator">/</span>lamda<span class="token punctuation">]</span></code></pre>
<p>Least squares provides reasonable estimate of the error variance. This estimate can be helpful in other methods (e.g. maximum likelihood and bayes), so we’ll save it.</p>
<pre class="language-stata" tabindex="0"><code class="language-stata"><span class="token comment">// σ² ≈ MSE = RSS / (n - p)</span>
<span class="token command keyword">local</span> sigma <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token function">e</span><span class="token punctuation">(</span>rss<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>_N <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<p>One benefit of <code>nl</code> is the ability to use <code>predictnl</code> to generate new variables based on the parameters. Note, though, that we can only do this if the model can be written as an expression in addition to or instead of a program. That's the case here. As an option, we can also ask for confidence intervals.</p>
<pre class="language-stata" tabindex="0"><code class="language-stata"><span class="token keyword">quietly</span> <span class="token command keyword">predictnl</span> pred_nl <span class="token operator">=</span> <span class="token punctuation">(</span>_b<span class="token punctuation">[</span><span class="token operator">/</span>alpha<span class="token punctuation">]</span> <span class="token operator">-</span> _b<span class="token punctuation">[</span><span class="token operator">/</span>beta<span class="token punctuation">]</span> <span class="token operator">*</span> _b<span class="token punctuation">[</span><span class="token operator">/</span>lamda<span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">///</span>
    <span class="token command keyword">ci</span><span class="token punctuation">(</span>low_nl high_nl<span class="token punctuation">)</span></code></pre>
<h2 id="bayesian-mcmc">Bayesian (MCMC)</h2>
<p>For a completely different approach, we can use Bayesian analysis to parameterize our model. As with non-linear regression, Stata can do that easily; all it needs is the expression corresponding to our model as well as our prior probabilities. We’ll use standard non-informative priors and the same initial guesses as above.</p>
<pre class="language-stata" tabindex="0"><code class="language-stata"><span class="token command keyword">bayesmh</span> y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>alpha<span class="token punctuation">}</span> <span class="token operator">-</span> <span class="token punctuation">{</span>beta<span class="token punctuation">}</span> <span class="token operator">*</span> <span class="token punctuation">{</span>lamda<span class="token punctuation">}</span> <span class="token operator">^</span> x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">///</span>
    <span class="token command keyword">likelihood</span><span class="token punctuation">(</span><span class="token function">normal</span><span class="token punctuation">(</span><span class="token punctuation">{</span>var<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">prior</span><span class="token punctuation">(</span><span class="token punctuation">{</span>alpha beta<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token function">normal</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">prior</span><span class="token punctuation">(</span><span class="token punctuation">{</span>lamda<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token function">uniform</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">prior</span><span class="token punctuation">(</span><span class="token punctuation">{</span>var<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token function">igamma</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">initial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>alpha<span class="token punctuation">}</span> <span class="token variable">`alpha'</span> <span class="token punctuation">{</span>beta<span class="token punctuation">}</span> <span class="token variable">`beta'</span> <span class="token punctuation">{</span>lamda<span class="token punctuation">}</span> <span class="token variable">`lamda'</span> <span class="token punctuation">{</span>var<span class="token punctuation">}</span> <span class="token variable">`sigma'</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span></code></pre>
<p>For more complicated models, we can use a custom “program evaluator.” A log-likelihood evaluator is simpler than a log-posterior evaluator because we're okay using built-in distributions as priors for the parameters.</p>
<p>Our model has no linear combinations for the independent variable <math><mi>x</mi></math>, so ideally we would just define a constraint that fixed the slope. Currently the <code>bayesmh</code> command doesn't allow constraints with program evaluators, though. To work around that and avoid any spurious warnings for variables that we don't use, we pass <code>x</code> as an extra variable instead. Here’s a program evaluator for our example.</p>
<pre class="language-stata" tabindex="0"><code class="language-stata"><span class="token keyword">capture</span> <span class="token command keyword">program</span> drop growth_lleval
<span class="token command keyword">program</span> define growth_lleval
    <span class="token comment">// Arguments:</span>
    <span class="token comment">//   lnden: the name of a temporary scalar to be filled in with an overall</span>
    <span class="token comment">//          log-likelihood value</span>
    <span class="token comment">//   alpha, beta, lamda, sigma: model parameters (not linear equations)</span>
    <span class="token command keyword">args</span> lnden alpha beta lamda sigma

    <span class="token comment">// Make the code a little bit more readable with clearer references</span>
    <span class="token command keyword">local</span> x <span class="token string-literal"><span class="token string">"$MH_extravars"</span></span>
    <span class="token command keyword">local</span> y <span class="token string-literal"><span class="token string">"$MH_y"</span></span>

    <span class="token command keyword">tempvar</span> lnfj
    <span class="token keyword">quietly</span> <span class="token command keyword">generate</span> double <span class="token variable">`lnfj'</span> <span class="token operator">=</span> <span class="token comment">///</span>
        <span class="token command keyword">lnnormalden</span><span class="token punctuation">(</span><span class="token variable">`y'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token variable">`alpha'</span> <span class="token operator">-</span> <span class="token variable">`beta'</span> <span class="token operator">*</span> <span class="token variable">`lamda'</span> <span class="token operator">^</span> <span class="token variable">`x'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">`sigma'</span><span class="token punctuation">)</span> <span class="token comment">///</span>
        <span class="token command keyword">if</span> <span class="token variable">$MH_touse</span>

    <span class="token command keyword">summarize</span> <span class="token variable">`lnfj'</span><span class="token punctuation">,</span> meanonly

    <span class="token comment">// If there was a problem, don't report an actual result but return a</span>
    <span class="token comment">// missing value instead. This is the Stata convention. To detect problems</span>
    <span class="token comment">// we ensure that the number of generated values is the same as the number</span>
    <span class="token comment">// of observations.</span>
    <span class="token command keyword">if</span> <span class="token function">r</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token variable">$MH_n</span> <span class="token punctuation">{</span>
        <span class="token command keyword">scalar</span> <span class="token variable">`lnden'</span> <span class="token operator">=</span> .
        <span class="token command keyword">exit</span>
    <span class="token punctuation">}</span>

    <span class="token command keyword">scalar</span> <span class="token variable">`lnden'</span> <span class="token operator">=</span> <span class="token function">r</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span>
<span class="token command keyword">end</span></code></pre>
<p>And here’s how we use that program to estimate posterior parameter values.</p>
<pre class="language-stata" tabindex="0"><code class="language-stata"><span class="token comment">// Bayes results include the MCMC posteriors and require significantly more</span>
<span class="token comment">// storage space. Use a temporary file to hold them.</span>
<span class="token command keyword">tempfile</span> bayes_file

<span class="token command keyword">bayesmh</span> y<span class="token punctuation">,</span> noconstant <span class="token comment">///</span>
    <span class="token command keyword">llevaluator</span><span class="token punctuation">(</span> <span class="token comment">///</span>
        <span class="token command keyword">growth_lleval</span><span class="token punctuation">,</span> <span class="token comment">///</span>
        <span class="token command keyword">extravars</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token comment">///</span>
        <span class="token command keyword">parameters</span><span class="token punctuation">(</span><span class="token punctuation">{</span>alpha<span class="token punctuation">}</span> <span class="token punctuation">{</span>beta<span class="token punctuation">}</span> <span class="token punctuation">{</span>lamda<span class="token punctuation">}</span> <span class="token punctuation">{</span>sigma<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">prior</span><span class="token punctuation">(</span><span class="token punctuation">{</span>alpha beta<span class="token punctuation">}</span><span class="token punctuation">,</span> flat<span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">prior</span><span class="token punctuation">(</span><span class="token punctuation">{</span>lamda<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token function">uniform</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">prior</span><span class="token punctuation">(</span><span class="token punctuation">{</span>sigma<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token function">igamma</span><span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">initial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>alpha<span class="token punctuation">}</span> <span class="token variable">`alpha'</span> <span class="token punctuation">{</span>beta<span class="token punctuation">}</span> <span class="token variable">`beta'</span> <span class="token punctuation">{</span>lamda<span class="token punctuation">}</span> <span class="token variable">`lamda'</span> <span class="token punctuation">{</span>sigma<span class="token punctuation">}</span> <span class="token variable">`sigma'</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">saving</span><span class="token punctuation">(</span><span class="token variable">`bayes_file'</span><span class="token punctuation">)</span>

<span class="token comment">// For a simple comparison, save the mean values from the MCMC posterior</span>
<span class="token command keyword">local</span> alpha_bs <span class="token operator">=</span> <span class="token function">e</span><span class="token punctuation">(</span>mean<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"alpha"</span></span><span class="token punctuation">]</span>
<span class="token command keyword">local</span> beta_bs  <span class="token operator">=</span> <span class="token function">e</span><span class="token punctuation">(</span>mean<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"beta"</span></span><span class="token punctuation">]</span>
<span class="token command keyword">local</span> lamda_bs <span class="token operator">=</span> <span class="token function">e</span><span class="token punctuation">(</span>mean<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"lamda"</span></span><span class="token punctuation">]</span>
<span class="token command keyword">local</span> sigma_bs <span class="token operator">=</span> <span class="token function">e</span><span class="token punctuation">(</span>mean<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"sigma"</span></span><span class="token punctuation">]</span>
<span class="token command keyword">local</span> mcmc_samples <span class="token operator">=</span> <span class="token function">e</span><span class="token punctuation">(</span>mcmcsize<span class="token punctuation">)</span></code></pre>
<p>With the Bayesian approach, Stata lets us perform more extensive analyses. To do that, we can load the posterior data in a separate data frame. The resulting dataset will contain the parameter values realized in the <abbr>MCMC</abbr> chains. With a small bit of housekeeping, we can randomly sample from those posterior values. The final results include these samples as a way to visualize our model’s uncertainty as a Bayesian alternative to confidence intervals.</p>
<pre class="language-stata" tabindex="0"><code class="language-stata"><span class="token command keyword">tempname</span> posterior
<span class="token command keyword">frame</span> create <span class="token variable">`posterior'</span>
<span class="token keyword">frame</span> <span class="token variable">`posterior'</span><span class="token punctuation">:</span> <span class="token command keyword">use</span> <span class="token variable">`bayes_file'</span>
<span class="token keyword">quietly</span> <span class="token command keyword">frame</span> <span class="token variable">`posterior'</span> <span class="token punctuation">{</span>
    <span class="token command keyword">expand</span> _frequency
    <span class="token command keyword">keep</span> eq<span class="token operator">*</span>
    <span class="token command keyword">rename</span> eq0_p1 alpha
    <span class="token command keyword">rename</span> eq0_p2 beta
    <span class="token command keyword">rename</span> eq0_p3 lamda
    <span class="token command keyword">rename</span> eq0_p4 sigma
    <span class="token command keyword">generate</span> double randu <span class="token operator">=</span> <span class="token function">runiform</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token command keyword">isid</span> randu
    <span class="token command keyword">sort</span> randu
<span class="token punctuation">}</span></code></pre>
<h2 id="maximum-likelihood-ml-estimation">Maximum Likelihood (ml) Estimation</h2>
<p>Finally, Stata also support maximum likelihood estimates. As with our previous approaches, we can do that simply with a substitutable expression.</p>
<pre class="language-stata" tabindex="0"><code class="language-stata"><span class="token command keyword">mlexp</span> <span class="token punctuation">(</span><span class="token function">lnnormalden</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token punctuation">{</span>alpha<span class="token punctuation">}</span> <span class="token operator">-</span> <span class="token punctuation">{</span>beta<span class="token punctuation">}</span> <span class="token operator">*</span> <span class="token punctuation">{</span>lamda<span class="token punctuation">}</span> <span class="token operator">^</span> x<span class="token punctuation">,</span> <span class="token punctuation">{</span>sigma<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">///</span>
    <span class="token command keyword">from</span><span class="token punctuation">(</span>alpha <span class="token operator">=</span> <span class="token variable">`alpha'</span> beta <span class="token operator">=</span> <span class="token variable">`beta'</span> lamda <span class="token operator">=</span> <span class="token variable">`lamda'</span> sigma <span class="token operator">=</span> <span class="token variable">`sigma'</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">difficult</span> nolog

<span class="token comment">// The "predictnl" command also works after "mlexp"</span>
<span class="token keyword">quietly</span> <span class="token command keyword">predictnl</span> pred_ml <span class="token operator">=</span> <span class="token punctuation">(</span>_b<span class="token punctuation">[</span><span class="token operator">/</span>alpha<span class="token punctuation">]</span> <span class="token operator">-</span> _b<span class="token punctuation">[</span><span class="token operator">/</span>beta<span class="token punctuation">]</span> <span class="token operator">*</span> _b<span class="token punctuation">[</span><span class="token operator">/</span>lamda<span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">///</span>
    <span class="token command keyword">ci</span><span class="token punctuation">(</span>low_ml high_ml<span class="token punctuation">)</span></code></pre>
<p>More complex problems may benefit from a complete “program.”  To demonstrate that, we use the linear form for the maximum likelihood estimation, so this program is a “method-lf evaluator.” Method-lf evaluators are required to evaluate the observation-by-observation log likelihood <code>ln(Lj), j = 1, …, N</code> where the subscript <code>j</code> indexes the observations. Because the model doesn't have any parameters that create linear functions of <math><mi>x</mi></math> (i.e. no scale or location) we constrain the linear coefficient to be 1. We'll also force the constant term to be zero when we execute the <code>ml</code> command.</p>
<pre class="language-stata" tabindex="0"><code class="language-stata"><span class="token command keyword">constraint</span> define <span class="token number">1</span> <span class="token punctuation">[</span>xb<span class="token punctuation">]</span><span class="token punctuation">:</span>x <span class="token operator">=</span> <span class="token number">1</span>

<span class="token keyword">capture</span> <span class="token command keyword">program</span> drop growth_lfeval
<span class="token command keyword">program</span> define growth_lfeval
    <span class="token comment">// Arguments:</span>
    <span class="token comment">//   lnfj: variable to be filled in with observation-by-observation</span>
    <span class="token comment">//         values of ln(Lj)</span>
    <span class="token comment">//   x: independent variable obtained via a linear equation where the</span>
    <span class="token comment">//      slope is constrained to be 1 (above) and no constant is allowed</span>
    <span class="token comment">//      (below)</span>
    <span class="token comment">//   alpha, beta, lamda, sigma: model parameters (not linear equations)</span>
    <span class="token command keyword">args</span> lnfj x alpha beta lamda sigma

    <span class="token comment">// Get access to the dependent variable (y). This isn't strictly</span>
    <span class="token comment">// necessary (and possibly degrades performance), but it makes the</span>
    <span class="token comment">// expressions easier to read.</span>
    <span class="token command keyword">local</span> y <span class="token variable">$ML_y1</span>

    <span class="token keyword">quietly</span> <span class="token command keyword">replace</span> <span class="token variable">`lnfj'</span> <span class="token operator">=</span> <span class="token comment">///</span>
        <span class="token command keyword">lnnormalden</span><span class="token punctuation">(</span><span class="token variable">`y'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token variable">`alpha'</span> <span class="token operator">-</span> <span class="token variable">`beta'</span> <span class="token operator">*</span> <span class="token variable">`lamda'</span> <span class="token operator">^</span> <span class="token variable">`x'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">`sigma'</span><span class="token punctuation">)</span> <span class="token comment">///</span>
        <span class="token command keyword">if</span> <span class="token variable">$ML_samp</span> <span class="token operator">==</span> <span class="token number">1</span>
<span class="token command keyword">end</span></code></pre>
<p>This is non-interactive mode, so the <code>maximize</code> option is specified. We also specify <code>nopreserve</code> as good practice even though it has no effect for linearform (lf) methods. In general, it tells Stata to assume that the evaluator is correctly using <code>$ML_samp</code>; without that assumption Stata takes extra precautions that degrade performance.</p>
<pre class="language-stata" tabindex="0"><code class="language-stata"><span class="token command keyword">ml</span> model linearform growth_lfeval <span class="token comment">///</span>
    <span class="token punctuation">(</span>xb<span class="token punctuation">:</span> y <span class="token operator">=</span> x<span class="token punctuation">,</span> noconstant<span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token punctuation">(</span>alpha<span class="token punctuation">:</span><span class="token punctuation">,</span> freeparm<span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token punctuation">(</span>beta<span class="token punctuation">:</span><span class="token punctuation">,</span>  freeparm<span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token punctuation">(</span>lamda<span class="token punctuation">:</span><span class="token punctuation">,</span> freeparm<span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token punctuation">(</span>sigma<span class="token punctuation">:</span><span class="token punctuation">,</span> freeparm<span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token punctuation">,</span> <span class="token function">constraint</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">init</span><span class="token punctuation">(</span>xb<span class="token punctuation">:</span>x <span class="token operator">=</span> <span class="token number">1</span> alpha <span class="token operator">=</span> <span class="token variable">`alpha'</span> beta <span class="token operator">=</span> <span class="token variable">`beta'</span> lamda <span class="token operator">=</span> <span class="token variable">`lamda'</span> sigma <span class="token operator">=</span> <span class="token variable">`sigma'</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">maximize</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token boolean">off</span><span class="token punctuation">)</span> difficult nolog nopreserve

<span class="token command keyword">local</span> alpha_ml <span class="token operator">=</span> _b<span class="token punctuation">[</span><span class="token operator">/</span>alpha<span class="token punctuation">]</span>
<span class="token command keyword">local</span> beta_ml  <span class="token operator">=</span> _b<span class="token punctuation">[</span><span class="token operator">/</span>beta<span class="token punctuation">]</span>
<span class="token command keyword">local</span> lamda_ml <span class="token operator">=</span> _b<span class="token punctuation">[</span><span class="token operator">/</span>lamda<span class="token punctuation">]</span>
<span class="token command keyword">local</span> sigma_ml <span class="token operator">=</span> _b<span class="token punctuation">[</span><span class="token operator">/</span>sigma<span class="token punctuation">]</span></code></pre>
<h2 id="the-results">The Results</h2>
<p>Thankfully, all of the different modeling approaches yield similar results, as table 2 indicates. We can also compare the models by visualizing models based on the estimated parameters. Figure 1 shows that comparison. The final panel uses mean estimates from each approach to show all of them on a single plot.</p>
<table>
<caption>Stata results for multiple models compared to Stan estimates (with 95% confidence intervals or 95% credible sets)</caption>
<thead>
<tr>
<th></th>
<th><math><mi>α</mi></math></th>
<th><math><mi>β</mi></math></th>
<th><math><mi>λ</mi></math></th>
</tr>
</thead>
<tbody>
<tr>
<td>Stan</td>
<td>2.7 [2.6, 2.8]</td>
<td>0.97 [0.85, 1.1]</td>
<td>0.86 [0.81, 0.91]</td>
</tr>
<tr>
<td><code>nl</code> expression</td>
<td>2.66 [2.53, 2.79]</td>
<td>0.96 [0.82, 1.11]</td>
<td>0.87 [0.82 0.92]</td>
</tr>
<tr>
<td><code>nl</code> program</td>
<td>2.66 [2.53, 2.79]</td>
<td>0.96 [0.82, 1.11]</td>
<td>0.87 [0.82 0.92]</td>
</tr>
<tr>
<td><code>bayesmh</code> expression</td>
<td>2.65 [2.49, 2.87]</td>
<td>0.98 [0.79, 1.19]</td>
<td>0.85 [0.75, 0.93]</td>
</tr>
<tr>
<td><code>bayesmh</code> program</td>
<td>2.65 [2.54, 2.80]</td>
<td>0.97 [0.80, 1.11]</td>
<td>0.86 [0.80, 0.91]</td>
</tr>
<tr>
<td><code>mlexp</code></td>
<td>2.65 [2.54, 2.78]</td>
<td>0.96 [0.83, 1.09]</td>
<td>0.87 [0.82, 0.92]</td>
</tr>
<tr>
<td><code>ml</code> program</td>
<td>2.65</td>
<td>0.96</td>
<td>0.87</td>
</tr>
</tbody>
</table>
<pre class="language-stata" tabindex="0"><code class="language-stata"><span class="token command keyword">gr_setscheme</span>
<span class="token command keyword">local</span> color1 `.__SCHEME.color.p1'
<span class="token command keyword">local</span> color2 `.__SCHEME.color.p2'
<span class="token command keyword">local</span> color3 `.__SCHEME.color.p3'
<span class="token command keyword">local</span> color4 `.__SCHEME.color.p4'
<span class="token command keyword">local</span> color5 `.__SCHEME.color.p5'
<span class="token command keyword">local</span> color6 `.__SCHEME.color.p6'
<span class="token command keyword">local</span> ciarea `.__SCHEME.color.ci_area'
<span class="token command keyword">local</span> ciline `.__SCHEME.color.ci_line'

<span class="token comment">// One plot for each method separately to highlight that method's unique</span>
<span class="token comment">// features, and then a combined plot to allow comparison of the results.</span>

<span class="token comment">// Non-linear Least Squares - include confidence interval</span>
<span class="token command keyword">twoway</span> <span class="token comment">///</span>
    <span class="token punctuation">(</span>rarea low_nl high_nl x<span class="token punctuation">,</span> <span class="token function">fcolor</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token expression"><span class="token variable">`ciarea'</span></span></span><span class="token string">"</span></span><span class="token punctuation">)</span> <span class="token function">lwidth</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token punctuation">(</span>function y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">`alpha_nl'</span> <span class="token operator">-</span> <span class="token variable">`beta_nl'</span> <span class="token operator">*</span> <span class="token variable">`lamda_nl'</span> <span class="token operator">^</span> x<span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">///</span>
        <span class="token command keyword">range</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token function">lcolor</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token expression"><span class="token variable">`color3'</span></span></span><span class="token string">"</span></span><span class="token punctuation">)</span> <span class="token function">lwidth</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token punctuation">(</span>scatter y x<span class="token punctuation">,</span> <span class="token function">mcolor</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token expression"><span class="token variable">`color1'</span></span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">///</span>
    <span class="token command keyword">legend</span><span class="token punctuation">(</span><span class="token boolean">off</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">title</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Non-linear Least Squares"</span></span><span class="token punctuation">,</span> <span class="token function">size</span><span class="token punctuation">(</span>11pt<span class="token punctuation">)</span> <span class="token function">position</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token function">ring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">subtitle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"w/ 95% CI"</span></span><span class="token punctuation">,</span> <span class="token function">size</span><span class="token punctuation">(</span>10pt<span class="token punctuation">)</span> <span class="token function">position</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token function">ring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">xtitle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">""</span></span><span class="token punctuation">)</span> <span class="token function">xlabel</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span> <span class="token function">ytitle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">""</span></span><span class="token punctuation">)</span> <span class="token function">ylabel</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">name</span><span class="token punctuation">(</span>nl<span class="token punctuation">,</span> replace<span class="token punctuation">)</span> nodraw

<span class="token comment">// Maximum Likelihood - also with confidence interval</span>
<span class="token command keyword">twoway</span> <span class="token comment">///</span>
    <span class="token punctuation">(</span>rarea low_ml high_ml x<span class="token punctuation">,</span> <span class="token function">fcolor</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token expression"><span class="token variable">`ciarea'</span></span></span><span class="token string">"</span></span><span class="token punctuation">)</span> <span class="token function">lwidth</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token punctuation">(</span>function y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">`alpha_ml'</span> <span class="token operator">-</span> <span class="token variable">`beta_ml'</span> <span class="token operator">*</span> <span class="token variable">`lamda_ml'</span> <span class="token operator">^</span> x<span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">///</span>
        <span class="token command keyword">range</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token function">lcolor</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token expression"><span class="token variable">`color4'</span></span></span><span class="token string">"</span></span><span class="token punctuation">)</span> <span class="token function">lwidth</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token punctuation">(</span>scatter y x<span class="token punctuation">,</span> <span class="token function">mcolor</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token expression"><span class="token variable">`color1'</span></span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">///</span>
    <span class="token command keyword">legend</span><span class="token punctuation">(</span><span class="token boolean">off</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">title</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Maximum Likelihood"</span></span><span class="token punctuation">,</span> <span class="token function">size</span><span class="token punctuation">(</span>11pt<span class="token punctuation">)</span> <span class="token function">position</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token function">ring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">subtitle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"w/ 95% CI"</span></span><span class="token punctuation">,</span> <span class="token function">size</span><span class="token punctuation">(</span>10pt<span class="token punctuation">)</span> <span class="token function">position</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token function">ring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">xtitle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">""</span></span><span class="token punctuation">)</span> <span class="token function">xlabel</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span> <span class="token function">ytitle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">""</span></span><span class="token punctuation">)</span> <span class="token function">ylabel</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">name</span><span class="token punctuation">(</span>ml<span class="token punctuation">,</span> replace<span class="token punctuation">)</span> nodraw

<span class="token comment">// Bayesian - show plausible trajectories by sampling from the posterior</span>
<span class="token command keyword">forvalues</span> sample <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">500</span> <span class="token punctuation">{</span>
    <span class="token command keyword">local</span> i <span class="token operator">=</span> <span class="token function">runiformint</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token variable">`mcmc_samples'</span><span class="token punctuation">)</span>
    <span class="token command keyword">local</span> a <span class="token operator">=</span> <span class="token function">_frval</span><span class="token punctuation">(</span><span class="token variable">`posterior'</span><span class="token punctuation">,</span> alpha<span class="token punctuation">,</span> <span class="token variable">`i'</span><span class="token punctuation">)</span>
    <span class="token command keyword">local</span> b <span class="token operator">=</span> <span class="token function">_frval</span><span class="token punctuation">(</span><span class="token variable">`posterior'</span><span class="token punctuation">,</span> beta<span class="token punctuation">,</span>  <span class="token variable">`i'</span><span class="token punctuation">)</span>
    <span class="token command keyword">local</span> l <span class="token operator">=</span> <span class="token function">_frval</span><span class="token punctuation">(</span><span class="token variable">`posterior'</span><span class="token punctuation">,</span> lamda<span class="token punctuation">,</span> <span class="token variable">`i'</span><span class="token punctuation">)</span>
    <span class="token command keyword">local</span> graph <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token expression"><span class="token variable">`graph'</span></span></span><span class="token string"> (function y = (</span><span class="token interpolation"><span class="token expression"><span class="token variable">`a'</span></span></span><span class="token string"> - </span><span class="token interpolation"><span class="token expression"><span class="token variable">`b'</span></span></span><span class="token string"> * </span><span class="token interpolation"><span class="token expression"><span class="token variable">`l'</span></span></span><span class="token string"> ^ x),"</span></span>
    <span class="token command keyword">local</span> graph <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token expression"><span class="token variable">`graph'</span></span></span><span class="token string"> range(x) lwidth(thin) lcolor(</span><span class="token interpolation"><span class="token expression"><span class="token variable">`ciline'</span></span></span><span class="token string">%05))"</span></span>
<span class="token punctuation">}</span>

<span class="token command keyword">twoway</span> <span class="token comment">///</span>
    <span class="token variable">`graph'</span> <span class="token comment">///</span>
    <span class="token punctuation">(</span>function y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">`alpha_bs'</span> <span class="token operator">-</span> <span class="token variable">`beta_bs'</span> <span class="token operator">*</span> <span class="token variable">`lamda_bs'</span> <span class="token operator">^</span> x<span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">///</span>
        <span class="token command keyword">range</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token function">lcolor</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token expression"><span class="token variable">`color5'</span></span></span><span class="token string">"</span></span><span class="token punctuation">)</span> <span class="token function">lwidth</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token punctuation">(</span>scatter y x<span class="token punctuation">,</span> <span class="token function">mcolor</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token expression"><span class="token variable">`color1'</span></span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">///</span>
    <span class="token command keyword">legend</span><span class="token punctuation">(</span><span class="token boolean">off</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">title</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Bayesian (MCMC)"</span></span><span class="token punctuation">,</span> <span class="token function">size</span><span class="token punctuation">(</span>11pt<span class="token punctuation">)</span> <span class="token function">position</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token function">ring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">subtitle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"w/ 500 posterior samples"</span></span><span class="token punctuation">,</span> <span class="token function">size</span><span class="token punctuation">(</span>10pt<span class="token punctuation">)</span> <span class="token function">position</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token function">ring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">xtitle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">""</span></span><span class="token punctuation">)</span> <span class="token function">xlabel</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span> <span class="token function">ytitle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">""</span></span><span class="token punctuation">)</span> <span class="token function">ylabel</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">name</span><span class="token punctuation">(</span><span class="token keyword">bayes</span><span class="token punctuation">,</span> replace<span class="token punctuation">)</span> nodraw

<span class="token comment">// Summarized results on single plot - using mean values for parameters</span>
<span class="token command keyword">twoway</span> <span class="token comment">///</span>
    <span class="token punctuation">(</span>function y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">`alpha_nl'</span> <span class="token operator">-</span> <span class="token variable">`beta_nl'</span> <span class="token operator">*</span> <span class="token variable">`lamda_nl'</span> <span class="token operator">^</span> x<span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">///</span>
        <span class="token command keyword">range</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token function">lcolor</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token expression"><span class="token variable">`color3'</span></span></span><span class="token string">"</span></span><span class="token punctuation">)</span> <span class="token function">lwidth</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token punctuation">(</span>function y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">`alpha_ml'</span> <span class="token operator">-</span> <span class="token variable">`beta_ml'</span> <span class="token operator">*</span> <span class="token variable">`lamda_ml'</span> <span class="token operator">^</span> x<span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">///</span>
        <span class="token command keyword">range</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token function">lcolor</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token expression"><span class="token variable">`color4'</span></span></span><span class="token string">"</span></span><span class="token punctuation">)</span> <span class="token function">lwidth</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token punctuation">(</span>function y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">`alpha_bs'</span> <span class="token operator">-</span> <span class="token variable">`beta_bs'</span> <span class="token operator">*</span> <span class="token variable">`lamda_bs'</span> <span class="token operator">^</span> x<span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">///</span>
        <span class="token command keyword">range</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token function">lcolor</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token expression"><span class="token variable">`color5'</span></span></span><span class="token string">"</span></span><span class="token punctuation">)</span> <span class="token function">lwidth</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token punctuation">(</span>scatter y x<span class="token punctuation">,</span> <span class="token function">mcolor</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token expression"><span class="token variable">`color1'</span></span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">///</span>
    <span class="token command keyword">subtitle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"Mean Estimates"</span></span><span class="token punctuation">,</span> <span class="token function">size</span><span class="token punctuation">(</span>11pt<span class="token punctuation">)</span> <span class="token function">position</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token function">ring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">legend</span><span class="token punctuation">(</span><span class="token function">order</span><span class="token punctuation">(</span> <span class="token comment">///</span>
        <span class="token number">4</span> <span class="token string-literal"><span class="token string">"Observations"</span></span> <span class="token comment">///</span>
        <span class="token number">1</span> <span class="token string-literal"><span class="token string">"Non-linear Least Squares"</span></span> <span class="token comment">///</span>
        <span class="token number">2</span> <span class="token string-literal"><span class="token string">"Maximum Likelihood"</span></span> <span class="token comment">///</span>
        <span class="token number">3</span> <span class="token string-literal"><span class="token string">"Bayesian (MCMC)"</span></span> <span class="token comment">///</span>
    <span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">rowgap</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">keygap</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">symxsize</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token function">size</span><span class="token punctuation">(</span>8pt<span class="token punctuation">)</span> <span class="token function">region</span><span class="token punctuation">(</span><span class="token function">margin</span><span class="token punctuation">(</span>small<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">cols</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">position</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token function">ring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">xtitle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">""</span></span><span class="token punctuation">)</span> <span class="token function">xlabel</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span> <span class="token function">ytitle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">""</span></span><span class="token punctuation">)</span> <span class="token function">ylabel</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span> <span class="token comment">///</span>
    <span class="token command keyword">name</span><span class="token punctuation">(</span>all<span class="token punctuation">,</span> replace<span class="token punctuation">)</span> nodraw

<span class="token command keyword">graph</span> combine nl ml <span class="token keyword">bayes</span> all<span class="token punctuation">,</span> <span class="token function">cols</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token function">name</span><span class="token punctuation">(</span>models<span class="token punctuation">,</span> replace<span class="token punctuation">)</span></code></pre>
<figure>
<p><picture><source type="image/avif" srcset="/blog/statamodels/qqYb3mrGxQ-2096.avif 2096w"><source type="image/webp" srcset="/blog/statamodels/qqYb3mrGxQ-2096.webp 2096w"><img loading="lazy" decoding="async" src="/blog/statamodels/qqYb3mrGxQ-2096.png" alt="Stata model fitting approaches" width="2096" height="1304"></picture></p>
<p><picture><source type="image/avif" srcset="/blog/statamodels/9zsg1OKpjV-2096.avif 2096w"><source type="image/webp" srcset="/blog/statamodels/9zsg1OKpjV-2096.webp 2096w"><img loading="lazy" decoding="async" src="/blog/statamodels/9zsg1OKpjV-2096.png" alt="Stata model fitting approaches" width="2096" height="1304"></picture></p>
<figcaption>Stata Model Fitting Approaches</figcaption>
</figure>
<p>All of the approaches yield very similar results, though each has its own strengths and weaknesses. I tend to use non-linear least squares for “quick and dirty” analysis and follow up with Bayesian estimates if I want more thorough or more detailed results. Maximum likelihood is an alternative for those cases where Bayesian analysis may not be appropriate.</p>


		</main>

		<footer>
			<nav>
				<h2 class="visually-hidden" id="other-ways-to-find-or-follow-me">Other ways to find or follow me</h2>
				<ul class="nav">
					<li class="nav-item"><a class="a--icon" href="/feed/feed.xml">
						<span class="icon">
<svg viewBox="0 -960 180 180" xmlns="http://www.w3.org/2000/svg">
  <title>This blog in a news reader</title>
  <path d="M 36.075 -800 C 31.563 -800 27.755 -801.591 24.653 -804.772 C 21.551 -807.955 20 -811.78 20 -816.247 C 20 -820.716 21.574 -824.519 24.723 -827.656 C 27.87 -830.795 31.655 -832.364 36.075 -832.364 C 40.554 -832.364 44.388 -830.813 47.579 -827.711 C 50.769 -824.609 52.364 -820.801 52.364 -816.289 C 52.364 -811.776 50.769 -807.933 47.579 -804.761 C 44.388 -801.587 40.554 -800 36.075 -800 Z M 134.125 -800 C 134.125 -815.882 131.159 -830.711 125.225 -844.487 C 119.292 -858.265 111.13 -870.331 100.739 -880.686 C 90.349 -891.042 78.265 -899.186 64.487 -905.119 C 50.711 -911.053 35.882 -914.02 20 -914.02 L 20 -940 C 39.522 -940 57.713 -936.359 74.574 -929.077 C 91.434 -921.794 106.239 -911.764 118.987 -898.987 C 131.764 -886.239 141.794 -871.434 149.077 -854.574 C 156.359 -837.713 160 -819.522 160 -800 L 134.125 -800 Z M 82.27 -800 C 82.27 -808.653 80.642 -816.725 77.387 -824.216 C 74.132 -831.706 69.662 -838.293 63.977 -843.977 C 58.293 -849.662 51.706 -854.132 44.216 -857.387 C 36.725 -860.642 28.653 -862.27 20 -862.27 L 20 -888.145 C 32.318 -888.145 43.799 -885.83 54.444 -881.2 C 65.088 -876.57 74.402 -870.263 82.386 -862.278 C 90.369 -854.294 96.676 -844.992 101.306 -834.37 C 105.936 -823.749 108.251 -812.292 108.251 -800 L 82.27 -800 Z" fill="currentColor"></path>
</svg>
</span>
					</a></li>
					<li class="nav-item"><a class="a--icon" rel="me" href="https://fediscience.org/@stephen_thomas">
						<span class="icon">
<svg viewBox="0 0 180 180" xmlns="http://www.w3.org/2000/svg">
  <title>Me on social media</title>
  <path d="M 174.695 39.849 C 172.066 20.511 155.024 5.268 134.825 2.315 C 131.416 1.816 118.505 0 88.592 0 L 88.368 0 C 58.449 0 52.029 1.816 48.623 2.315 C 28.984 5.185 11.051 18.882 6.699 38.451 C 4.606 48.088 4.384 58.773 4.772 68.573 C 5.326 82.63 5.434 96.66 6.724 110.659 C 7.617 119.957 9.173 129.181 11.381 138.261 C 15.517 155.034 32.259 168.991 48.664 174.684 C 66.226 180.621 85.112 181.607 103.209 177.531 C 105.201 177.072 107.169 176.541 109.115 175.935 C 113.508 174.552 118.662 173.006 122.451 170.29 C 122.502 170.253 122.545 170.202 122.575 170.147 C 122.605 170.089 122.622 170.027 122.624 169.962 L 122.624 156.4 C 122.622 156.34 122.608 156.28 122.582 156.227 C 122.555 156.174 122.515 156.125 122.467 156.091 C 122.421 156.054 122.365 156.026 122.305 156.014 C 122.248 156.001 122.185 156.001 122.128 156.014 C 110.534 158.754 98.651 160.127 86.732 160.106 C 66.217 160.106 60.699 150.476 59.118 146.467 C 57.849 143.001 57.044 139.387 56.721 135.716 C 56.716 135.656 56.727 135.594 56.753 135.538 C 56.778 135.481 56.817 135.432 56.866 135.393 C 56.914 135.354 56.972 135.326 57.032 135.312 C 57.092 135.298 57.157 135.301 57.217 135.317 C 68.617 138.037 80.305 139.411 92.033 139.406 C 94.855 139.406 97.666 139.406 100.488 139.332 C 112.283 139.007 124.717 138.409 136.322 136.166 C 136.611 136.111 136.902 136.06 137.149 135.986 C 155.456 132.511 172.876 121.597 174.646 93.96 C 174.713 92.871 174.877 82.565 174.877 81.434 C 174.886 77.599 176.128 54.217 174.695 39.849 Z M 146.52 108.808 L 127.272 108.808 L 127.272 62.176 C 127.272 52.359 123.136 47.352 114.725 47.352 C 105.475 47.352 100.844 53.276 100.844 64.973 L 100.844 90.499 L 81.711 90.499 L 81.711 64.973 C 81.711 53.276 77.07 47.352 67.821 47.352 C 59.457 47.352 55.281 52.359 55.274 62.176 L 55.274 108.808 L 36.041 108.808 L 36.041 60.762 C 36.041 50.945 38.575 43.145 43.643 37.364 C 48.87 31.595 55.728 28.634 64.239 28.634 C 74.091 28.634 81.535 32.382 86.499 39.866 L 91.29 47.818 L 96.088 39.866 C 101.049 32.382 108.494 28.634 118.329 28.634 C 126.833 28.634 133.692 31.595 138.935 37.364 C 144.005 43.138 146.539 50.938 146.539 60.762 L 146.52 108.808 Z" fill="currentColor"></path>
</svg>
</span>
					</a></li>
					<li class="nav-item"><a class="a--icon " href="https://github.com/sathomas">
						<span class="icon">
<svg viewBox="0 0 180 180" xmlns="http://www.w3.org/2000/svg">
  <title>My open source software</title>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M 90.074 1.5 C 40.266 1.5 0 42.062 0 92.244 C 0 132.356 25.8 166.311 61.59 178.328 C 66.065 179.232 67.704 176.376 67.704 173.973 C 67.704 171.87 67.557 164.659 67.557 157.146 C 42.5 162.555 37.282 146.328 37.282 146.328 C 33.256 135.812 27.289 133.109 27.289 133.109 C 19.088 127.55 27.887 127.55 27.887 127.55 C 36.984 128.151 41.757 136.864 41.757 136.864 C 49.809 150.685 62.783 146.78 68.003 144.376 C 68.748 138.516 71.135 134.46 73.671 132.207 C 53.686 130.103 32.66 122.291 32.66 87.435 C 32.66 77.52 36.237 69.407 41.905 63.098 C 41.01 60.845 37.878 51.528 42.801 39.059 C 42.801 39.059 50.406 36.655 67.555 48.374 C 74.897 46.388 82.469 45.378 90.074 45.368 C 97.68 45.368 105.433 46.421 112.592 48.374 C 129.743 36.655 137.348 39.059 137.348 39.059 C 142.271 51.528 139.137 60.845 138.242 63.098 C 144.059 69.407 147.489 77.52 147.489 87.435 C 147.489 122.291 126.463 129.952 106.329 132.207 C 109.611 135.061 112.443 140.469 112.443 149.033 C 112.443 161.202 112.295 170.968 112.295 173.972 C 112.295 176.376 113.936 179.232 118.409 178.33 C 154.2 166.309 180 132.356 180 92.244 C 180.147 42.062 139.734 1.5 90.074 1.5 Z" fill="currentColor"></path>
</svg>
</span>
					</a></li>
					<li class="nav-item"><a class="a--icon" href="https://scholar.google.com/citations?hl=en&user=d8x-U-AAAAAJ&view_op=list_works&sortby=pubdate">
						<span class="icon">
<svg viewBox="0 0 180 180" xmlns="http://www.w3.org/2000/svg">
  <title>My academic publications</title>
  <path d="M 137.426 104.941 C 137.426 104.941 137.426 104.977 137.461 104.977 C 140.695 111.797 142.523 119.426 142.523 127.477 C 142.488 156.48 119.004 180 90 180 C 60.996 180 37.512 156.48 37.512 127.512 C 37.512 119.461 39.34 111.832 42.574 105.012 C 43.172 103.746 43.84 102.48 44.543 101.25 C 46.09 98.578 47.848 96.082 49.816 93.762 C 59.449 82.301 73.898 75.023 90.035 75.023 C 101.848 75.023 112.746 78.926 121.535 85.535 C 124.734 87.961 127.652 90.703 130.254 93.797 C 132.223 96.117 133.98 98.648 135.527 101.285 C 136.23 102.48 136.863 103.746 137.461 104.977 L 137.426 104.941 Z M 146.707 98.332 C 136.125 77.801 114.715 63.738 90 63.738 C 65.285 63.738 43.875 77.801 33.293 98.332 L 0 71.262 L 90 0 L 180 71.262 L 146.707 98.367 L 146.707 98.332 Z" fill="currentColor"></path>
</svg>
</span>
					</a></li>
					<li class="nav-item"><a class="a--icon" href="https://amazon.com/author/sathomas">
						<span class="icon">
<svg viewBox="0 0 180 180" xmlns="http://www.w3.org/2000/svg">
  <title>Some books I've written</title>
  <path d="M 104.054 56.075 C 100.336 56.37 96.041 56.665 91.744 57.243 C 85.167 58.088 78.589 59.243 73.156 61.811 C 62.573 66.124 55.418 75.284 55.418 88.753 C 55.418 105.666 66.291 114.244 80.016 114.244 C 84.603 114.244 88.317 113.685 91.744 112.822 C 97.19 111.103 101.768 107.949 107.2 102.23 C 110.355 106.525 111.206 108.534 116.646 113.116 C 118.074 113.693 119.502 113.693 120.648 112.829 C 124.079 109.971 130.08 104.812 133.235 101.948 C 134.658 100.79 134.376 99.084 133.522 97.643 C 130.367 93.633 127.23 90.189 127.23 82.465 L 127.23 56.678 C 127.23 45.774 128.076 35.755 120.083 28.313 C 113.497 22.278 103.2 20 95.199 20 C 94.053 20 92.912 20 91.762 20 C 77.174 20.855 61.731 27.146 58.291 45.214 C 57.727 47.493 59.449 48.364 60.591 48.655 L 76.606 50.668 C 78.324 50.364 79.179 48.942 79.461 47.501 C 80.905 41.214 86.047 38.059 91.766 37.482 C 92.057 37.482 92.344 37.482 92.917 37.482 C 96.344 37.482 100.059 38.923 102.067 41.765 C 104.336 45.214 104.067 49.806 104.067 53.806 L 104.054 56.075 Z M 100.909 90.171 C 98.908 94.185 95.472 96.762 91.753 97.626 C 91.185 97.626 90.335 97.921 89.471 97.921 C 83.18 97.921 79.448 93.048 79.448 85.88 C 79.448 76.724 84.889 72.411 91.753 70.411 C 95.472 69.557 99.768 69.262 104.059 69.262 L 104.059 72.702 C 104.054 79.297 104.323 84.448 100.909 90.171 Z M 166.841 129.956 L 166.841 130.889 C 166.69 136.491 163.735 147.239 156.74 153.153 C 155.342 154.238 153.941 153.618 154.558 152.051 C 156.593 147.083 161.244 135.549 159.07 132.907 C 157.529 130.889 151.147 131.041 145.71 131.51 C 143.228 131.822 141.046 131.965 139.335 132.304 C 137.786 132.447 137.466 131.058 139.028 129.974 C 141.05 128.572 143.232 127.487 145.714 126.694 C 154.562 124.055 164.832 125.608 166.234 127.327 C 166.537 127.77 166.841 128.703 166.841 129.956 Z M 152.08 140.848 C 150.058 142.397 147.892 143.806 145.71 145.07 C 129.391 154.88 108.26 160 89.927 160 C 60.391 160 33.974 149.101 13.932 130.889 C 12.214 129.483 13.616 127.465 15.638 128.55 C 37.238 141.16 63.966 148.797 91.628 148.797 C 109.04 148.797 127.825 145.525 145.705 138.509 C 146.943 138.057 148.343 137.415 149.589 136.964 C 152.387 135.702 154.878 138.838 152.08 140.848 Z" fill="currentColor"></path>
</svg></span>
					</a></li>
					<li class="nav-item"><a class="a--icon" href="https://www.strava.com/athletes/4858512">
						<span class="icon">
<svg viewBox="0 0 180 180" xmlns="http://www.w3.org/2000/svg">
  <title>My free time</title>
  <path d="M 115.402 134.58 L 99.734 103.71 L 76.747 103.71 L 115.402 180 L 154.027 103.71 L 131.032 103.71 M 78.472 61.717 L 99.742 103.702 L 131.032 103.702 L 78.472 0 L 25.972 103.71 L 57.239 103.71" fill="currentColor"></path>
</svg>
</span>
					</a></li>
				</ul>
			</nav>
		</footer>

		<!-- This page `/blog/statamodels/` was built on 2025-04-13T18:32:31.931Z -->
		
	</body>
</html>
